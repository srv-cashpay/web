{
    "sourceFile": "layout/AppTopbar.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1736741923717,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1736741923717,
            "name": "Commit-0",
            "content": "import getConfig from 'next/config';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport { classNames } from 'primereact/utils';\r\nimport React, { forwardRef, useContext, useImperativeHandle, useRef } from 'react';\r\nimport { LayoutContext } from './context/layoutcontext';\r\n\r\nconst AppTopbar = forwardRef((props, ref) => {\r\n    const { layoutConfig, layoutState, onMenuToggle, showProfileSidebar } = useContext(LayoutContext);\r\n    const menubuttonRef = useRef(null);\r\n    const topbarmenuRef = useRef(null);\r\n    const topbarmenubuttonRef = useRef(null);\r\n    const contextPath = getConfig().publicRuntimeConfig.contextPath;\r\n    const router = useRouter();\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        menubutton: menubuttonRef.current,\r\n        topbarmenu: topbarmenuRef.current,\r\n        topbarmenubutton: topbarmenubuttonRef.current\r\n    }));\r\n\r\n    const deleteCookie = (name) => {\r\n        document.cookie = `${name}=; Max-Age=-99999999; path=/; login;`;\r\n    };\r\n\r\n    const getCookie = (name) => {\r\n        const value = `; ${document.cookie}`;\r\n        const parts = value.split(`; ${name}=`);\r\n        if (parts.length === 2) return parts.pop().split(';').shift();\r\n    };\r\n\r\n    const handleLogout = async () => {\r\n        const token = getCookie('token'); // Mengambil token dari cookie\r\n\r\n        try {\r\n            const response = await fetch('http://192.168.14.248:2356/api/logout', {\r\n                method: 'POST', // Atur metode sesuai kebutuhan API Anda\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}` // Menggunakan token dari cookie\r\n                }\r\n            });\r\n    \r\n            if (response.ok) {\r\n                // Sukses logout\r\n                console.log('Logout successful');\r\n                \r\n                // Hapus token dari storage (jika ada)\r\n                // Misal, jika Anda menyimpan token di local storage:\r\n                deleteCookie('token');\r\n                deleteCookie('refresh_token');\r\n\r\n                localStorage.removeItem('token');\r\n\r\n                // Redirect ke halaman login atau halaman lain yang sesuai\r\n                router.push('/accounts/tap/login');\r\n            } else {\r\n                // Handle kesalahan logout\r\n                console.error('Failed to logout', response);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error during logout', error);\r\n        }\r\n    };\r\n    \r\n\r\n    return (\r\n        <div className=\"layout-topbar\">\r\n            <Link href=\"/\">\r\n                <a className=\"layout-topbar-logo\">\r\n                    <>\r\n                        {/* <img src={`${contextPath}/layout/images/logo-${layoutConfig.colorScheme !== 'light' ? 'white' : 'dark'}.svg`} width=\"47.22px\" height={'35px'} widt={'true'} alt=\"logo\" /> */}\r\n                        <span>CashPay</span>\r\n                    </>\r\n                </a>\r\n            </Link>\r\n\r\n            <button ref={menubuttonRef} type=\"button\" className=\"p-link layout-menu-button layout-topbar-button\" onClick={onMenuToggle}>\r\n                <i className=\"pi pi-bars\" />\r\n            </button>\r\n\r\n            <button ref={topbarmenubuttonRef} type=\"button\" className=\"p-link layout-topbar-menu-button layout-topbar-button\" onClick={showProfileSidebar}>\r\n                <i className=\"pi pi-ellipsis-v\" />\r\n            </button>\r\n\r\n            <div ref={topbarmenuRef} className={classNames('layout-topbar-menu', { 'layout-topbar-menu-mobile-active': layoutState.profileSidebarVisible })}>\r\n                {/* <button type=\"button\" className=\"p-link layout-topbar-button\">\r\n                    <i className=\"pi pi-calendar\"></i>\r\n                    <span>Calendar</span>\r\n                </button> */}\r\n                <Link href=\"/accounts/tap/d/for/profile\">\r\n                <button type=\"button\" className=\"p-link layout-topbar-button\">\r\n                    <i className=\"pi pi-user\"></i>\r\n                    <span>Profile</span>\r\n                </button>\r\n                </Link>\r\n\r\n                {/* <Link href=\"/\">\r\n                    <button type=\"button\" className=\"p-link layout-topbar-button\">\r\n                        <i className=\"pi pi-cog\"></i>\r\n                        <span>Settings</span>\r\n                    </button>\r\n                </Link> */}\r\n                    <button type=\"button\" className=\"p-link layout-topbar-button\" onClick={handleLogout}>\r\n                        <i className=\"pi pi-sign-out\"></i>\r\n                        <span>Logout</span>\r\n                    </button>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default AppTopbar;\r\n"
        }
    ]
}