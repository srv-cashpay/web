{
    "sourceFile": "pages/password/request-forgot-password.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1736741923651,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1736741923651,
            "name": "Commit-0",
            "content": "import getConfig from 'next/config';\r\nimport { useRouter } from 'next/router';\r\nimport React, { useContext, useState } from 'react';\r\nimport AppConfig from '../../layout/AppConfig';\r\nimport { Button } from 'primereact/button';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { classNames } from 'primereact/utils';\r\nimport axios from 'axios';\r\nimport Link from 'next/link';\r\nimport { LayoutContext } from '../../layout/context/layoutcontext';\r\n\r\nconst RequestForgotPassword = () => {\r\n    const [email, setEmail] = useState('');\r\n    const [notification, setNotification] = useState({ type: '', message: '' });\r\n    const { layoutConfig } = useContext(LayoutContext);\r\n    const router = useRouter();\r\n\r\n    const containerClassName = classNames(\r\n        'surface-ground flex align-items-center justify-content-center min-h-screen min-w-screen overflow-hidden',\r\n        { 'p-input-filled': layoutConfig.inputStyle === 'filled' }\r\n    );\r\n\r\n    const handleForgot = async () => {\r\n        setNotification({ type: '', message: '' }); // Reset notification\r\n        try {\r\n            const response = await axios.post(\r\n                'http://192.168.14.248:2356/api/auth/request-reset-password',\r\n                { email },\r\n                {\r\n                    headers: {\r\n                        'X-Api-Key': '3f=Pr#g1@RU-nw=30'  // Adding the custom API key header\r\n                    }\r\n                }\r\n            );\r\n    \r\n\r\n            if (response.status === 200) {\r\n                const data = response.data;\r\n                setNotification({ type: 'success', message: 'Password reset email sent successfully!' });\r\n                setTimeout(() => {\r\n                    router.push(`/password/verify-reset-password?token=${data.data.token}`);  // Pass token as a query parameter\r\n                }, 2000);\r\n            } else {\r\n                handleLoginError(response);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error during request:', error);\r\n            setNotification({ type: 'error', message: 'An unexpected error occurred.' });\r\n        }\r\n    };\r\n\r\n    const handleLoginError = async (response) => {\r\n        const errorMessage = response?.data?.meta?.message || response?.data?.error || 'An error occurred.';\r\n        setNotification({ type: 'error', message: errorMessage });\r\n    };\r\n\r\n    return (\r\n        <div className={containerClassName}>\r\n            <div className=\"flex flex-column align-items-center justify-content-center\">\r\n            <div style={{ borderRadius: '56px', padding: '0.3rem', background: 'linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)' }}>\r\n\r\n                    <div className=\"w-full surface-card py-8 px-5 sm:px-8\" style={{ borderRadius: '53px' }}>\r\n                    <div className=\"text-center mb-5\">\r\n                    <div className=\"text-900 text-2xl font-medium mb-2\">Reset Your Password</div>\r\n                            {notification.message && (\r\n                                <div\r\n                                    className={classNames(\r\n                                        'p-2 rounded text-center mb-3',\r\n                                        notification.type === 'error' ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'\r\n                                    )}\r\n                                    style={{ fontSize: '0.9rem' }}\r\n                                >\r\n                                    {notification.message}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label htmlFor=\"email1\" className=\"block text-900 text-lg font-medium mb-2\">\r\n                                Email Address\r\n                            </label>\r\n                            <InputText\r\n                                id=\"email1\"\r\n                                type=\"text\"\r\n                                value={email}\r\n                                onChange={(e) => setEmail(e.target.value)}\r\n                                className=\"w-full\"\r\n                                style={{ padding: '0.75rem', fontSize: '1rem' }}\r\n                                placeholder=\"Enter your email\"\r\n                            />\r\n                            <Button\r\n                                className=\"w-full mt-4\"\r\n                                style={{\r\n                                    padding: '0.75rem',\r\n                                    fontSize: '1rem',\r\n                                    fontWeight: 'bold',\r\n                                }}\r\n                                onClick={handleForgot}\r\n                            >\r\n                                Send Reset Link\r\n                            </Button>\r\n                            <div className=\"text-center mt-4\">\r\n                                <span className=\"text-600\">Don't have an account? </span>\r\n                                <Link href=\"/accounts/tap/register\">\r\n                                    <a\r\n                                        className=\"font-medium\"\r\n                                        style={{ color: 'var(--primary-color)', textDecoration: 'underline' }}\r\n                                    >\r\n                                        Register here\r\n                                    </a>\r\n                                </Link>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nRequestForgotPassword.getLayout = function getLayout(page) {\r\n    return (\r\n        <React.Fragment>\r\n            {page}\r\n            <AppConfig simple />\r\n        </React.Fragment>\r\n    );\r\n};\r\n\r\nexport default RequestForgotPassword;\r\n"
        }
    ]
}