{
    "sourceFile": "pages/pages/permission/index.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1736923079121,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1736923106860,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,37 +8,37 @@\n import { Toolbar } from 'primereact/toolbar';\r\n import React, { useEffect, useRef, useState } from 'react';\r\n import withAuth from '../../../layout/context/withAuth';\r\n import { Dropdown } from 'primereact/dropdown'; \r\n-import { fetchRoles, createRole,updateExistingRole, bulkDeleteRoles } from './api'; // Pastikan jalur ini sesuai\r\n-import { deleteRole as deleteRoleById } from './api';\r\n-import RoleCreateDialog from './Dialogs/PermissionCreateDialog';  // Import komponen RoleDialog\r\n-import RoleUpdateDialog from './Dialogs/PermissionUpdateDialog';\r\n+import { fetchPermissions, createPermission,updateExistingPermission, bulkDeletePermissions } from './api'; // Pastikan jalur ini sesuai\r\n+import { deletePermission as deletePermissionById } from './api';\r\n+import PermissionCreateDialog from './Dialogs/PermissionCreateDialog';  // Import komponen PermissionDialog\r\n+import PermissionUpdateDialog from './Dialogs/PermissionUpdateDialog';\r\n import { Badge } from 'primereact/badge';\r\n \r\n const Inventory = () => {\r\n-    let emptyRole = {\r\n+    let emptyPermission = {\r\n         id: null,\r\n         permission :{\r\n             permission: '',\r\n         },\r\n     }; \r\n \r\n-    const [permissions, setRoles] = useState(null);\r\n-    const [permissionDialog, setRoleDialog] = useState(false);\r\n-    const [permissionUpdateDialog, setRoleUpdateDialog] = useState(false);\r\n-    const [deleteRoleDialog, setDeleteRoleDialog] = useState(false);\r\n-    const [deleteRolesDialog, setDeleteRolesDialog] = useState(false);\r\n-    const [permission, setRole] = useState(emptyRole);\r\n-    const [selectedRoles, setSelectedRoles] = useState(null);\r\n+    const [permissions, setPermissions] = useState(null);\r\n+    const [permissionDialog, setPermissionDialog] = useState(false);\r\n+    const [permissionUpdateDialog, setPermissionUpdateDialog] = useState(false);\r\n+    const [deletePermissionDialog, setDeletePermissionDialog] = useState(false);\r\n+    const [deletePermissionsDialog, setDeletePermissionsDialog] = useState(false);\r\n+    const [permission, setPermission] = useState(emptyPermission);\r\n+    const [selectedPermissions, setSelectedPermissions] = useState(null);\r\n     const [submitted, setSubmitted] = useState(false);\r\n     const [globalFilter, setGlobalFilter] = useState(null);\r\n     const toast = useRef(null);\r\n     const dt = useRef(null);\r\n     const [rowsPerPage, setRowsPerPage] = useState(10); // Default 10\r\n \r\n-    const hideRoleDialog = () => {\r\n-        setShowRoleDialog(false);\r\n+    const hidePermissionDialog = () => {\r\n+        setShowPermissionDialog(false);\r\n     };\r\n     \r\n     const handleRowsPerPageChange = (newRowsPerPage) => {\r\n         setRowsPerPage(newRowsPerPage);\r\n@@ -56,10 +56,10 @@\n     \r\n     useEffect(() => {\r\n         const fetchData = async () => {\r\n             try {\r\n-                const response = await fetchRoles({ page: paginationData.page, limit: rowsPerPage,  totalPages: paginationData.totalPages});\r\n-                setRoles(Array.isArray(response.rows) ? response.rows : []);\r\n+                const response = await fetchPermissions({ page: paginationData.page, limit: rowsPerPage,  totalPages: paginationData.totalPages});\r\n+                setPermissions(Array.isArray(response.rows) ? response.rows : []);\r\n \r\n                 setPaginationData(prev => ({\r\n                     ...prev,\r\n                     totalPages: response.total_page,  // Ambil total halaman dari respons API\r\n@@ -78,79 +78,79 @@\n     }, [paginationData.page, rowsPerPage, paginationData.totalPages]); \r\n    \r\n \r\n     const openNew = () => {\r\n-        setRole(emptyRole);\r\n+        setPermission(emptyPermission);\r\n         setSubmitted(false);\r\n-        setRoleDialog(true);\r\n+        setPermissionDialog(true);\r\n     };\r\n \r\n     const openEdit = (permissionData) => {\r\n-        setRole({ ...permissionData });\r\n+        setPermission({ ...permissionData });\r\n         setSubmitted(false);\r\n-        setRoleUpdateDialog(true);\r\n+        setPermissionUpdateDialog(true);\r\n     };\r\n     \r\n \r\n     const hideDialog = () => {\r\n         setSubmitted(false);\r\n-        setRoleDialog(false);\r\n+        setPermissionDialog(false);\r\n     };\r\n \r\n     const hideUpdateDialog = () => {\r\n         setSubmitted(false);\r\n-        setRoleUpdateDialog(false);\r\n+        setPermissionUpdateDialog(false);\r\n     };\r\n \r\n-    const hideDeleteRoleDialog = () => {\r\n-        setDeleteRoleDialog(false);\r\n+    const hideDeletePermissionDialog = () => {\r\n+        setDeletePermissionDialog(false);\r\n     };\r\n \r\n-    const hideDeleteRolesDialog = () => {\r\n-        setDeleteRolesDialog(false);\r\n+    const hideDeletePermissionsDialog = () => {\r\n+        setDeletePermissionsDialog(false);\r\n     };\r\n \r\n-    const saveRole = () => {\r\n+    const savePermission = () => {\r\n         saveDataToApi();        \r\n     };\r\n \r\n     const saveDataToApi = async () => {\r\n         try { \r\n-            const response = await createRole(permission);\r\n+            const response = await createPermission(permission);\r\n             toast.current.show({ severity: 'success', summary: 'Successful', detail: response.message, life: 3000 });\r\n         } catch (error) {\r\n             console.error(\"Error saving data:\", error);\r\n             toast.current.show({ severity: 'error', summary: 'Error', detail: error.response.data.meta.message, life: 3000 });\r\n         }\r\n     };\r\n \r\n-    const updateRole = () => {\r\n+    const updatePermission = () => {\r\n         updateDataToApi();\r\n     };\r\n     \r\n     const updateDataToApi = async () => {\r\n         try { \r\n-            const response = await updateExistingRole(permission); // Gantilah dengan fungsi update yang sesuai\r\n+            const response = await updateExistingPermission(permission); // Gantilah dengan fungsi update yang sesuai\r\n             toast.current.show({ severity: 'success', summary: 'Updated', detail: response.message, life: 3000 });\r\n         } catch (error) {\r\n             console.error(\"Error updating data:\", error);\r\n             toast.current.show({ severity: 'error', summary: 'Error', detail: error.response?.data?.meta?.message, life: 3000 });\r\n         }\r\n     };\r\n \r\n-    const confirmDeleteRole = (permission) => {\r\n-        setRole(permission);\r\n-        setDeleteRoleDialog(true);\r\n+    const confirmDeletePermission = (permission) => {\r\n+        setPermission(permission);\r\n+        setDeletePermissionDialog(true);\r\n     };\r\n     \r\n-    const deleteRole = async () => {\r\n+    const deletePermission = async () => {\r\n         try {\r\n-            await deleteRoleById(permission.id); // Use the renamed function to delete by id\r\n+            await deletePermissionById(permission.id); // Use the renamed function to delete by id\r\n             const _permissions = permissions.filter((val) => val.id !== permission.id);\r\n-            setRoles(_permissions);\r\n-            setDeleteRoleDialog(false);\r\n-            setRole(emptyRole);\r\n-            toast.current.show({ severity: 'success', summary: 'Successful', detail: 'Role Deleted', life: 3000 });\r\n+            setPermissions(_permissions);\r\n+            setDeletePermissionDialog(false);\r\n+            setPermission(emptyPermission);\r\n+            toast.current.show({ severity: 'success', summary: 'Successful', detail: 'Permission Deleted', life: 3000 });\r\n         } catch (error) {\r\n             console.error(\"Error deleting permission:\", error);\r\n             toast.current.show({ severity: 'error', summary: 'Error', detail: 'Failed to delete permission', life: 3000 });\r\n         }\r\n@@ -160,20 +160,20 @@\n         dt.current.exportCSV();\r\n     };\r\n \r\n     const confirmDeleteSelected = () => {\r\n-        setDeleteRolesDialog(true);\r\n+        setDeletePermissionsDialog(true);\r\n     };\r\n \r\n-    const bulkDeleteSelectedRoles = async () => {\r\n+    const bulkDeleteSelectedPermissions = async () => {\r\n         try {\r\n-            const selectedRoleIds = selectedRoles.map((permission) => permission.id);\r\n-            await bulkDeleteRoles(selectedRoleIds);\r\n-            const _permissions = permissions.filter((permission) => !selectedRoleIds.includes(permission.id));\r\n-            setRoles(_permissions);\r\n-            setDeleteRolesDialog(false);\r\n-            setSelectedRoles(null);\r\n-            toast.current.show({ severity: 'success', summary: 'Successful', detail: 'Roles Deleted', life: 3000 });\r\n+            const selectedPermissionIds = selectedPermissions.map((permission) => permission.id);\r\n+            await bulkDeletePermissions(selectedPermissionIds);\r\n+            const _permissions = permissions.filter((permission) => !selectedPermissionIds.includes(permission.id));\r\n+            setPermissions(_permissions);\r\n+            setDeletePermissionsDialog(false);\r\n+            setSelectedPermissions(null);\r\n+            toast.current.show({ severity: 'success', summary: 'Successful', detail: 'Permissions Deleted', life: 3000 });\r\n         } catch (error) {\r\n             console.error(\"Error deleting permissions:\", error);\r\n             toast.current.show({ severity: 'error', summary: 'Error', detail: 'Failed to delete permissions', life: 3000 });\r\n         }\r\n@@ -183,9 +183,9 @@\n         return (\r\n             <React.Fragment>\r\n                 <div className=\"my-2\">\r\n                     <Button label=\"New\" icon=\"pi pi-plus\" className=\"p-button-success mr-2\" onClick={openNew} />\r\n-                    <Button label=\"Bulk Delete\" icon=\"pi pi-trash\" className=\"p-button-danger mr-2\" onClick={confirmDeleteSelected} disabled={!selectedRoles || !selectedRoles.length} />\r\n+                    <Button label=\"Bulk Delete\" icon=\"pi pi-trash\" className=\"p-button-danger mr-2\" onClick={confirmDeleteSelected} disabled={!selectedPermissions || !selectedPermissions.length} />\r\n             </div>\r\n             </React.Fragment>\r\n         );\r\n     };\r\n@@ -239,33 +239,33 @@\n     const actionBodyTemplate = (rowData) => {\r\n         return (\r\n             <>\r\n                 <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success mr-1\" onClick={() => openEdit (rowData)} />\r\n-                <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => confirmDeleteRole(rowData)} />\r\n+                <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => confirmDeletePermission(rowData)} />\r\n             </>\r\n         );\r\n     };\r\n \r\n     const header = (\r\n         <div className=\"flex flex-column md:flex-row md:justify-content-between md:align-items-center\">\r\n-            <h5 className=\"m-0\">Manage Roles</h5>\r\n+            <h5 className=\"m-0\">Manage Permissions</h5>\r\n             <span className=\"block mt-2 md:mt-0 p-input-icon-left\">\r\n                 <i className=\"pi pi-search\" />\r\n                 <InputText type=\"search\" onInput={(e) => setGlobalFilter(e.target.value)} placeholder=\"Search...\" />\r\n             </span>\r\n         </div>\r\n     );\r\n \r\n-    const deleteRoleDialogFooter = (\r\n+    const deletePermissionDialogFooter = (\r\n         <>\r\n-            <Button label=\"No\" icon=\"pi pi-times\" className=\"p-button-text\" onClick={hideDeleteRoleDialog} />\r\n-            <Button label=\"Yes\" icon=\"pi pi-check\" className=\"p-button-text\" onClick={deleteRole} />\r\n+            <Button label=\"No\" icon=\"pi pi-times\" className=\"p-button-text\" onClick={hideDeletePermissionDialog} />\r\n+            <Button label=\"Yes\" icon=\"pi pi-check\" className=\"p-button-text\" onClick={deletePermission} />\r\n         </>\r\n     );\r\n-    const deleteRolesDialogFooter = (\r\n+    const deletePermissionsDialogFooter = (\r\n         <>\r\n-            <Button label=\"No\" icon=\"pi pi-times\" className=\"p-button-text\" onClick={hideDeleteRolesDialog} />\r\n-            <Button label=\"Yes\" icon=\"pi pi-check\" className=\"p-button-text\" onClick={bulkDeleteSelectedRoles} />\r\n+            <Button label=\"No\" icon=\"pi pi-times\" className=\"p-button-text\" onClick={hideDeletePermissionsDialog} />\r\n+            <Button label=\"Yes\" icon=\"pi pi-check\" className=\"p-button-text\" onClick={bulkDeleteSelectedPermissions} />\r\n \r\n         </>\r\n     );\r\n \r\n@@ -286,10 +286,10 @@\n \r\n                     <DataTable\r\n                        ref={dt}\r\n                        value={permissions}\r\n-                       selection={selectedRoles}\r\n-                       onSelectionChange={(e) => setSelectedRoles(e.value)}\r\n+                       selection={selectedPermissions}\r\n+                       onSelectionChange={(e) => setSelectedPermissions(e.value)}\r\n                        dataKey=\"id\"\r\n                        className=\"datatable-responsive\"\r\n                        globalFilter={globalFilter}\r\n                        emptyMessage=\"No permissions found.\"\r\n@@ -308,9 +308,9 @@\n                     <div className=\"flex justify-content-between align-items-center\">\r\n                         <Button icon=\"pi pi-angle-left\" className=\"p-button-text\" onClick={handlePreviousPage} disabled={paginationData.page === 1} />\r\n                         <span>{`Page ${paginationData.page} of ${paginationData.totalPages }`}</span>\r\n                         <Button icon=\"pi pi-angle-right\" className=\"p-button-text\" onClick={handleNextPage} disabled={paginationData.page === paginationData.totalPages} />\r\n-                        <span>{`Inventory ${paginationData.totalRows } Roles`}</span>\r\n+                        <span>{`Inventory ${paginationData.totalRows } Permissions`}</span>\r\n                     </div>\r\n                                 <Dropdown\r\n                         value={rowsPerPage}\r\n                         options={[10, 25, 50]} // Opsi untuk jumlah baris per halaman\r\n@@ -318,26 +318,26 @@\n                             placeholder=\"Rows per page\"\r\n                             className=\"ml-2\"\r\n                         />\r\n                 </div>              \r\n-                        <RoleCreateDialog\r\n+                        <PermissionCreateDialog\r\n                         visible={permissionDialog}\r\n                         permission={permission}\r\n-                        setRole={setRole}\r\n+                        setPermission={setPermission}\r\n                         hideDialog={hideDialog}\r\n-                        saveRole={saveRole}\r\n+                        savePermission={savePermission}\r\n                         submitted={submitted}\r\n                         />\r\n-                         <RoleUpdateDialog\r\n+                         <PermissionUpdateDialog\r\n                             visible={permissionUpdateDialog}\r\n                             permission={permission}\r\n-                            setRole={setRole}\r\n+                            setPermission={setPermission}\r\n                             hideDialog={hideUpdateDialog}\r\n-                            updateRole={updateRole}\r\n+                            updatePermission={updatePermission}\r\n                             submitted={submitted}\r\n                         />\r\n \r\n-                    <Dialog visible={deleteRoleDialog} style={{ width: '450px' }} header=\"Confirm\" modal footer={deleteRoleDialogFooter} onHide={hideDeleteRoleDialog}>\r\n+                    <Dialog visible={deletePermissionDialog} style={{ width: '450px' }} header=\"Confirm\" modal footer={deletePermissionDialogFooter} onHide={hideDeletePermissionDialog}>\r\n                         <div className=\"flex align-items-center justify-content-center\">\r\n                             <i className=\"pi pi-exclamation-triangle mr-3\" style={{ fontSize: '2rem' }} />\r\n                             {permission && (\r\n                                 <span>\r\n@@ -346,9 +346,9 @@\n                             )}\r\n                         </div>\r\n                     </Dialog>\r\n \r\n-                    <Dialog visible={deleteRolesDialog} style={{ width: '450px' }} header=\"Confirm\" modal footer={deleteRolesDialogFooter} onHide={hideDeleteRolesDialog}>\r\n+                    <Dialog visible={deletePermissionsDialog} style={{ width: '450px' }} header=\"Confirm\" modal footer={deletePermissionsDialogFooter} onHide={hideDeletePermissionsDialog}>\r\n                         <div className=\"flex align-items-center justify-content-center\">\r\n                             <i className=\"pi pi-exclamation-triangle mr-3\" style={{ fontSize: '2rem' }} />\r\n                             {permission && <span>Are you sure you want to delete the selected permissions?</span>}\r\n                         </div>\r\n"
                },
                {
                    "date": 1736930108373,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -208,9 +208,9 @@\n                 \r\n             }}\r\n             onClick={() => openEdit(rowData)}\r\n         >\r\n-            {rowData.full_name}\r\n+            {rowData.label}\r\n         </span>\r\n         );\r\n     };\r\n \r\n"
                },
                {
                    "date": 1736930140092,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -297,10 +297,9 @@\n                        responsiveLayout=\"scroll\"                   \r\n                     >\r\n                         <Column selectionMode=\"multiple\" headerStyle={{ width: '4rem' }}></Column>\r\n                         <Column field=\"nomor\" header=\"No\" body={nomorBodyTemplate} style={{ width: '5%' }} />\r\n-\r\n-                        <Column field=\"permission\" header=\"Name\" sortable body={nameBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n+                        <Column field=\"label\" header=\"label\" sortable body={nameBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n                         <Column field=\"created_by\" header=\"Created By\" sortable body={permissionBodyTemplate}></Column>\r\n                         <Column field=\"action\" body={actionBodyTemplate} ></Column>\r\n                     </DataTable>\r\n \r\n"
                },
                {
                    "date": 1736930324367,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,8 +50,9 @@\n         totaPages: 0,\r\n         limit: 10, // Default limit to 10\r\n         totalData: 0,\r\n         totalRows: 0,\r\n+        totalPages:0,\r\n         nextPage: 0,\r\n     });\r\n     \r\n     useEffect(() => {\r\n@@ -297,9 +298,9 @@\n                        responsiveLayout=\"scroll\"                   \r\n                     >\r\n                         <Column selectionMode=\"multiple\" headerStyle={{ width: '4rem' }}></Column>\r\n                         <Column field=\"nomor\" header=\"No\" body={nomorBodyTemplate} style={{ width: '5%' }} />\r\n-                        <Column field=\"label\" header=\"label\" sortable body={nameBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n+                        <Column field=\"label\" header=\"Label\" sortable body={nameBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n                         <Column field=\"created_by\" header=\"Created By\" sortable body={permissionBodyTemplate}></Column>\r\n                         <Column field=\"action\" body={actionBodyTemplate} ></Column>\r\n                     </DataTable>\r\n \r\n"
                },
                {
                    "date": 1736991096049,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -214,8 +214,26 @@\n         </span>\r\n         );\r\n     };\r\n \r\n+    const iconBodyTemplate = (rowData) => {\r\n+        return (\r\n+            <>\r\n+                <span className=\"p-column-title\">Icon</span>\r\n+                {rowData.icon}\r\n+            </>\r\n+        );\r\n+    };\r\n+\r\n+    const toBodyTemplate = (rowData) => {\r\n+        return (\r\n+            <>\r\n+                <span className=\"p-column-title\">To</span>\r\n+                {rowData.to}\r\n+            </>\r\n+        );\r\n+    };\r\n+\r\n     const permissionBodyTemplate = (rowData) => {\r\n         return (\r\n             <>\r\n                 <span className=\"p-column-title\">Created By</span>\r\n@@ -299,8 +317,10 @@\n                     >\r\n                         <Column selectionMode=\"multiple\" headerStyle={{ width: '4rem' }}></Column>\r\n                         <Column field=\"nomor\" header=\"No\" body={nomorBodyTemplate} style={{ width: '5%' }} />\r\n                         <Column field=\"label\" header=\"Label\" sortable body={nameBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n+                        <Column field=\"icon\" header=\"Icon\" sortable body={iconBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n+                        <Column field=\"to\" header=\"To\" sortable body={toBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n                         <Column field=\"created_by\" header=\"Created By\" sortable body={permissionBodyTemplate}></Column>\r\n                         <Column field=\"action\" body={actionBodyTemplate} ></Column>\r\n                     </DataTable>\r\n \r\n"
                }
            ],
            "date": 1736923079121,
            "name": "Commit-0",
            "content": "import { Button } from 'primereact/button';\r\nimport { Column } from 'primereact/column';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Dialog } from 'primereact/dialog';\r\nimport { FileUpload } from 'primereact/fileupload';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Toast } from 'primereact/toast';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport withAuth from '../../../layout/context/withAuth';\r\nimport { Dropdown } from 'primereact/dropdown'; \r\nimport { fetchRoles, createRole,updateExistingRole, bulkDeleteRoles } from './api'; // Pastikan jalur ini sesuai\r\nimport { deleteRole as deleteRoleById } from './api';\r\nimport RoleCreateDialog from './Dialogs/PermissionCreateDialog';  // Import komponen RoleDialog\r\nimport RoleUpdateDialog from './Dialogs/PermissionUpdateDialog';\r\nimport { Badge } from 'primereact/badge';\r\n\r\nconst Inventory = () => {\r\n    let emptyRole = {\r\n        id: null,\r\n        permission :{\r\n            permission: '',\r\n        },\r\n    }; \r\n\r\n    const [permissions, setRoles] = useState(null);\r\n    const [permissionDialog, setRoleDialog] = useState(false);\r\n    const [permissionUpdateDialog, setRoleUpdateDialog] = useState(false);\r\n    const [deleteRoleDialog, setDeleteRoleDialog] = useState(false);\r\n    const [deleteRolesDialog, setDeleteRolesDialog] = useState(false);\r\n    const [permission, setRole] = useState(emptyRole);\r\n    const [selectedRoles, setSelectedRoles] = useState(null);\r\n    const [submitted, setSubmitted] = useState(false);\r\n    const [globalFilter, setGlobalFilter] = useState(null);\r\n    const toast = useRef(null);\r\n    const dt = useRef(null);\r\n    const [rowsPerPage, setRowsPerPage] = useState(10); // Default 10\r\n\r\n    const hideRoleDialog = () => {\r\n        setShowRoleDialog(false);\r\n    };\r\n    \r\n    const handleRowsPerPageChange = (newRowsPerPage) => {\r\n        setRowsPerPage(newRowsPerPage);\r\n        setPaginationData(prev => ({ ...prev, limit: newRowsPerPage, page: 1 })); // Reset ke halaman 1 saat limit berubah\r\n    };\r\n    \r\n    const [paginationData, setPaginationData] = useState({\r\n        page: 1, // Start from page 1 as per your requirement\r\n        totaPages: 0,\r\n        limit: 10, // Default limit to 10\r\n        totalData: 0,\r\n        totalRows: 0,\r\n        nextPage: 0,\r\n    });\r\n    \r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                const response = await fetchRoles({ page: paginationData.page, limit: rowsPerPage,  totalPages: paginationData.totalPages});\r\n                setRoles(Array.isArray(response.rows) ? response.rows : []);\r\n\r\n                setPaginationData(prev => ({\r\n                    ...prev,\r\n                    totalPages: response.total_page,  // Ambil total halaman dari respons API\r\n                    totalData: response.total_data,\r\n                    totalRows: response.total_rows,\r\n                    nextPage: response.next_page\r\n                    \r\n                }));\r\n            } catch (error) {\r\n                console.error(\"Error fetching data:\", error);\r\n            }\r\n        };\r\n        fetchData();\r\n        console.log(\"Updated Pagination Data:\", paginationData);  // Log setiap kali paginationData berubah\r\n\r\n    }, [paginationData.page, rowsPerPage, paginationData.totalPages]); \r\n   \r\n\r\n    const openNew = () => {\r\n        setRole(emptyRole);\r\n        setSubmitted(false);\r\n        setRoleDialog(true);\r\n    };\r\n\r\n    const openEdit = (permissionData) => {\r\n        setRole({ ...permissionData });\r\n        setSubmitted(false);\r\n        setRoleUpdateDialog(true);\r\n    };\r\n    \r\n\r\n    const hideDialog = () => {\r\n        setSubmitted(false);\r\n        setRoleDialog(false);\r\n    };\r\n\r\n    const hideUpdateDialog = () => {\r\n        setSubmitted(false);\r\n        setRoleUpdateDialog(false);\r\n    };\r\n\r\n    const hideDeleteRoleDialog = () => {\r\n        setDeleteRoleDialog(false);\r\n    };\r\n\r\n    const hideDeleteRolesDialog = () => {\r\n        setDeleteRolesDialog(false);\r\n    };\r\n\r\n    const saveRole = () => {\r\n        saveDataToApi();        \r\n    };\r\n\r\n    const saveDataToApi = async () => {\r\n        try { \r\n            const response = await createRole(permission);\r\n            toast.current.show({ severity: 'success', summary: 'Successful', detail: response.message, life: 3000 });\r\n        } catch (error) {\r\n            console.error(\"Error saving data:\", error);\r\n            toast.current.show({ severity: 'error', summary: 'Error', detail: error.response.data.meta.message, life: 3000 });\r\n        }\r\n    };\r\n\r\n    const updateRole = () => {\r\n        updateDataToApi();\r\n    };\r\n    \r\n    const updateDataToApi = async () => {\r\n        try { \r\n            const response = await updateExistingRole(permission); // Gantilah dengan fungsi update yang sesuai\r\n            toast.current.show({ severity: 'success', summary: 'Updated', detail: response.message, life: 3000 });\r\n        } catch (error) {\r\n            console.error(\"Error updating data:\", error);\r\n            toast.current.show({ severity: 'error', summary: 'Error', detail: error.response?.data?.meta?.message, life: 3000 });\r\n        }\r\n    };\r\n\r\n    const confirmDeleteRole = (permission) => {\r\n        setRole(permission);\r\n        setDeleteRoleDialog(true);\r\n    };\r\n    \r\n    const deleteRole = async () => {\r\n        try {\r\n            await deleteRoleById(permission.id); // Use the renamed function to delete by id\r\n            const _permissions = permissions.filter((val) => val.id !== permission.id);\r\n            setRoles(_permissions);\r\n            setDeleteRoleDialog(false);\r\n            setRole(emptyRole);\r\n            toast.current.show({ severity: 'success', summary: 'Successful', detail: 'Role Deleted', life: 3000 });\r\n        } catch (error) {\r\n            console.error(\"Error deleting permission:\", error);\r\n            toast.current.show({ severity: 'error', summary: 'Error', detail: 'Failed to delete permission', life: 3000 });\r\n        }\r\n    };\r\n    \r\n    const exportCSV = () => {\r\n        dt.current.exportCSV();\r\n    };\r\n\r\n    const confirmDeleteSelected = () => {\r\n        setDeleteRolesDialog(true);\r\n    };\r\n\r\n    const bulkDeleteSelectedRoles = async () => {\r\n        try {\r\n            const selectedRoleIds = selectedRoles.map((permission) => permission.id);\r\n            await bulkDeleteRoles(selectedRoleIds);\r\n            const _permissions = permissions.filter((permission) => !selectedRoleIds.includes(permission.id));\r\n            setRoles(_permissions);\r\n            setDeleteRolesDialog(false);\r\n            setSelectedRoles(null);\r\n            toast.current.show({ severity: 'success', summary: 'Successful', detail: 'Roles Deleted', life: 3000 });\r\n        } catch (error) {\r\n            console.error(\"Error deleting permissions:\", error);\r\n            toast.current.show({ severity: 'error', summary: 'Error', detail: 'Failed to delete permissions', life: 3000 });\r\n        }\r\n    };    \r\n\r\n    const leftToolbarTemplate = () => {\r\n        return (\r\n            <React.Fragment>\r\n                <div className=\"my-2\">\r\n                    <Button label=\"New\" icon=\"pi pi-plus\" className=\"p-button-success mr-2\" onClick={openNew} />\r\n                    <Button label=\"Bulk Delete\" icon=\"pi pi-trash\" className=\"p-button-danger mr-2\" onClick={confirmDeleteSelected} disabled={!selectedRoles || !selectedRoles.length} />\r\n            </div>\r\n            </React.Fragment>\r\n        );\r\n    };\r\n\r\n    const rightToolbarTemplate = () => {\r\n        return (\r\n            <React.Fragment>\r\n                <FileUpload mode=\"basic\" accept=\"image/*\" maxFileSize={1000000} label=\"Import\" chooseLabel=\"Import\" className=\"mr-2 inline-block\" />\r\n                <Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />\r\n            </React.Fragment>\r\n        );\r\n    };\r\n\r\n    const nameBodyTemplate = (rowData) => {\r\n        return (\r\n            <span\r\n            style={{\r\n                cursor: 'pointer',\r\n                color: 'blue',\r\n                \r\n            }}\r\n            onClick={() => openEdit(rowData)}\r\n        >\r\n            {rowData.full_name}\r\n        </span>\r\n        );\r\n    };\r\n\r\n    const permissionBodyTemplate = (rowData) => {\r\n        return (\r\n            <>\r\n                <span className=\"p-column-title\">Created By</span>\r\n                {rowData.created_by}\r\n            </>\r\n        );\r\n    };\r\n\r\n    const handleNextPage = () => {\r\n        setPaginationData(prev => {\r\n            const nextPage = prev.page + 1;\r\n            return { ...prev, page: nextPage > prev.totalPages ? prev.totalPages : nextPage };\r\n        });\r\n    };\r\n    const handlePreviousPage = () => {\r\n        setPaginationData(prev => {\r\n            const previousPage = prev.page - 1;\r\n            return { ...prev, page: previousPage < 1 ? 1 : previousPage };\r\n        });\r\n    };\r\n\r\n    const actionBodyTemplate = (rowData) => {\r\n        return (\r\n            <>\r\n                <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success mr-1\" onClick={() => openEdit (rowData)} />\r\n                <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => confirmDeleteRole(rowData)} />\r\n            </>\r\n        );\r\n    };\r\n\r\n    const header = (\r\n        <div className=\"flex flex-column md:flex-row md:justify-content-between md:align-items-center\">\r\n            <h5 className=\"m-0\">Manage Roles</h5>\r\n            <span className=\"block mt-2 md:mt-0 p-input-icon-left\">\r\n                <i className=\"pi pi-search\" />\r\n                <InputText type=\"search\" onInput={(e) => setGlobalFilter(e.target.value)} placeholder=\"Search...\" />\r\n            </span>\r\n        </div>\r\n    );\r\n\r\n    const deleteRoleDialogFooter = (\r\n        <>\r\n            <Button label=\"No\" icon=\"pi pi-times\" className=\"p-button-text\" onClick={hideDeleteRoleDialog} />\r\n            <Button label=\"Yes\" icon=\"pi pi-check\" className=\"p-button-text\" onClick={deleteRole} />\r\n        </>\r\n    );\r\n    const deleteRolesDialogFooter = (\r\n        <>\r\n            <Button label=\"No\" icon=\"pi pi-times\" className=\"p-button-text\" onClick={hideDeleteRolesDialog} />\r\n            <Button label=\"Yes\" icon=\"pi pi-check\" className=\"p-button-text\" onClick={bulkDeleteSelectedRoles} />\r\n\r\n        </>\r\n    );\r\n\r\n    const nomorBodyTemplate = (_, { rowIndex }) => {\r\n        // Calculate the row number based on the current page and rows per page\r\n        const nomor = (paginationData.page - 1) * rowsPerPage + rowIndex + 1;\r\n        return (\r\n            <span>{nomor}</span>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"grid crud-demo\">\r\n            <div className=\"col-12\">\r\n                <div className=\"card\">\r\n                    <Toast ref={toast} />\r\n                    <Toolbar className=\"mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n                    <DataTable\r\n                       ref={dt}\r\n                       value={permissions}\r\n                       selection={selectedRoles}\r\n                       onSelectionChange={(e) => setSelectedRoles(e.value)}\r\n                       dataKey=\"id\"\r\n                       className=\"datatable-responsive\"\r\n                       globalFilter={globalFilter}\r\n                       emptyMessage=\"No permissions found.\"\r\n                       header={header}\r\n                       responsiveLayout=\"scroll\"                   \r\n                    >\r\n                        <Column selectionMode=\"multiple\" headerStyle={{ width: '4rem' }}></Column>\r\n                        <Column field=\"nomor\" header=\"No\" body={nomorBodyTemplate} style={{ width: '5%' }} />\r\n\r\n                        <Column field=\"permission\" header=\"Name\" sortable body={nameBodyTemplate} headerStyle={{ minWidth: '10rem' }}></Column>\r\n                        <Column field=\"created_by\" header=\"Created By\" sortable body={permissionBodyTemplate}></Column>\r\n                        <Column field=\"action\" body={actionBodyTemplate} ></Column>\r\n                    </DataTable>\r\n\r\n                    <div className=\"paginator-buttons\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n                    <div className=\"flex justify-content-between align-items-center\">\r\n                        <Button icon=\"pi pi-angle-left\" className=\"p-button-text\" onClick={handlePreviousPage} disabled={paginationData.page === 1} />\r\n                        <span>{`Page ${paginationData.page} of ${paginationData.totalPages }`}</span>\r\n                        <Button icon=\"pi pi-angle-right\" className=\"p-button-text\" onClick={handleNextPage} disabled={paginationData.page === paginationData.totalPages} />\r\n                        <span>{`Inventory ${paginationData.totalRows } Roles`}</span>\r\n                    </div>\r\n                                <Dropdown\r\n                        value={rowsPerPage}\r\n                        options={[10, 25, 50]} // Opsi untuk jumlah baris per halaman\r\n                            onChange={(e) => handleRowsPerPageChange(e.value)} // Panggil fungsi ketika nilai dropdown diubah\r\n                            placeholder=\"Rows per page\"\r\n                            className=\"ml-2\"\r\n                        />\r\n                </div>              \r\n                        <RoleCreateDialog\r\n                        visible={permissionDialog}\r\n                        permission={permission}\r\n                        setRole={setRole}\r\n                        hideDialog={hideDialog}\r\n                        saveRole={saveRole}\r\n                        submitted={submitted}\r\n                        />\r\n                         <RoleUpdateDialog\r\n                            visible={permissionUpdateDialog}\r\n                            permission={permission}\r\n                            setRole={setRole}\r\n                            hideDialog={hideUpdateDialog}\r\n                            updateRole={updateRole}\r\n                            submitted={submitted}\r\n                        />\r\n\r\n                    <Dialog visible={deleteRoleDialog} style={{ width: '450px' }} header=\"Confirm\" modal footer={deleteRoleDialogFooter} onHide={hideDeleteRoleDialog}>\r\n                        <div className=\"flex align-items-center justify-content-center\">\r\n                            <i className=\"pi pi-exclamation-triangle mr-3\" style={{ fontSize: '2rem' }} />\r\n                            {permission && (\r\n                                <span>\r\n                                    Are you sure you want to delete <b>{permission.permission}</b>?\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                    </Dialog>\r\n\r\n                    <Dialog visible={deleteRolesDialog} style={{ width: '450px' }} header=\"Confirm\" modal footer={deleteRolesDialogFooter} onHide={hideDeleteRolesDialog}>\r\n                        <div className=\"flex align-items-center justify-content-center\">\r\n                            <i className=\"pi pi-exclamation-triangle mr-3\" style={{ fontSize: '2rem' }} />\r\n                            {permission && <span>Are you sure you want to delete the selected permissions?</span>}\r\n                        </div>\r\n                    </Dialog>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default withAuth(Inventory);\r\n"
        }
    ]
}